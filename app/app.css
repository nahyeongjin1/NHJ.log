@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  /* Light Mode Colors (default) */
  :root,
  :root.light {
    --bg-primary: theme('colors.gray.100');
    --bg-secondary: theme('colors.gray.200');
    --bg-tertiary: theme('colors.gray.300');
    --bg-hover: theme('colors.gray.200');
    --bg-hover-subtle: color-mix(
      in srgb,
      theme('colors.gray.200') 50%,
      transparent
    );

    --text-primary: theme('colors.gray.800');
    --text-secondary: theme('colors.gray.600');
    --text-tertiary: theme('colors.gray.500');
    --text-muted: theme('colors.gray.400');

    --border-default: theme('colors.gray.200');
    --border-subtle: theme('colors.gray.100');
    --border-strong: theme('colors.gray.300');
  }

  /* Dark Mode Colors */
  :root.dark {
    --bg-primary: theme('colors.gray.900');
    --bg-secondary: theme('colors.gray.800');
    --bg-tertiary: theme('colors.gray.700');
    --bg-hover: theme('colors.gray.800');
    --bg-hover-subtle: color-mix(
      in srgb,
      theme('colors.gray.800') 50%,
      transparent
    );

    --text-primary: theme('colors.gray.200');
    --text-secondary: theme('colors.gray.400');
    --text-tertiary: theme('colors.gray.500');
    --text-muted: theme('colors.gray.600');

    --border-default: theme('colors.gray.800');
    --border-subtle: theme('colors.gray.900');
    --border-strong: theme('colors.gray.700');
  }

  /* Auto dark mode based on system preference (only if no explicit class) */
  @media (prefers-color-scheme: dark) {
    :root:not(.light):not(.dark) {
      --bg-primary: theme('colors.gray.900');
      --bg-secondary: theme('colors.gray.800');
      --bg-tertiary: theme('colors.gray.700');
      --bg-hover: theme('colors.gray.800');
      --bg-hover-subtle: color-mix(
        in srgb,
        theme('colors.gray.800') 50%,
        transparent
      );

      --text-primary: theme('colors.gray.200');
      --text-secondary: theme('colors.gray.400');
      --text-tertiary: theme('colors.gray.500');
      --text-muted: theme('colors.gray.600');

      --border-default: theme('colors.gray.800');
      --border-subtle: theme('colors.gray.900');
      --border-strong: theme('colors.gray.700');
    }
  }

  html,
  body {
    @apply bg-[var(--bg-primary)] text-[var(--text-primary)];
  }

  /* Typography Utilities */
  .heading-1 {
    @apply font-semibold text-3xl leading-[38px];
  }

  .heading-2 {
    @apply font-semibold text-2xl leading-8;
  }

  .heading-3 {
    @apply font-semibold text-xl leading-7;
  }

  .body-large {
    @apply font-normal text-xl leading-8;
  }

  .body {
    @apply font-normal text-base leading-6;
  }

  .body-small {
    @apply font-normal text-sm leading-5;
  }

  .label {
    @apply font-medium text-base leading-6;
  }

  .label-small {
    @apply font-normal text-sm leading-5;
  }

  .caption {
    @apply font-normal text-xs leading-4;
  }

  /* Code Block Styles (rehype-pretty-code) */
  pre {
    @apply font-mono text-sm p-4 rounded-lg overflow-x-auto;
  }

  pre > code {
    @apply font-mono;
    font-feature-settings:
      'liga' 1,
      'calt' 1; /* Fira Code ligatures */
  }

  /* Inline code */
  :not(pre) > code {
    @apply font-mono text-sm bg-secondary px-1.5 py-0.5 rounded;
  }
}

/* Prose (Typography) - CSS 변수 기반 색상 */
/* @layer base 밖에 위치해야 Tailwind Typography 기본값을 덮어씀 */
.prose {
  --tw-prose-body: var(--text-primary);
  --tw-prose-headings: var(--text-primary);
  --tw-prose-lead: var(--text-secondary);
  --tw-prose-links: var(--text-primary);
  --tw-prose-bold: var(--text-primary);
  --tw-prose-counters: var(--text-secondary);
  --tw-prose-bullets: var(--text-tertiary);
  --tw-prose-hr: var(--border-strong);
  --tw-prose-quotes: var(--text-primary);
  --tw-prose-quote-borders: var(--border-strong);
  --tw-prose-captions: var(--text-secondary);
  --tw-prose-code: var(--text-primary);
  --tw-prose-pre-code: var(--text-primary);
  --tw-prose-pre-bg: var(--bg-secondary);
  --tw-prose-th-borders: var(--border-strong);
  --tw-prose-td-borders: var(--border-default);
}

/* 테이블 가로 스크롤 */
.prose table {
  display: block;
  overflow-x: auto;
}
